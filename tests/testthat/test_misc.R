# test_misc.R

context("Make sure 'order' returns correct matrix")

cmat1 <- corrgram(mtcars, lower.panel = panel.conf, order = TRUE)

cmat2 <- structure(c(1, -0.852, -0.848, -0.776, 0.681, -0.868, 0.419, 
0.664, 0.6, 0.48, -0.551, -0.852, 1, 0.902, 0.832, -0.7, 0.782, 
-0.591, -0.811, -0.523, -0.493, 0.527, -0.848, 0.902, 1, 0.791, 
-0.71, 0.888, -0.434, -0.71, -0.591, -0.556, 0.395, -0.776, 0.832, 
0.791, 1, -0.449, 0.659, -0.708, -0.723, -0.243, -0.126, 0.75, 
0.681, -0.7, -0.71, -0.449, 1, -0.712, 0.091, 0.44, 0.713, 0.7, 
-0.091, -0.868, 0.782, 0.888, 0.659, -0.712, 1, -0.175, -0.555, 
-0.692, -0.583, 0.428, 0.419, -0.591, -0.434, -0.708, 0.091, 
-0.175, 1, 0.745, -0.23, -0.213, -0.656, 0.664, -0.811, -0.71, 
-0.723, 0.44, -0.555, 0.745, 1, 0.168, 0.206, -0.57, 0.6, -0.523, 
-0.591, -0.243, 0.713, -0.692, -0.23, 0.168, 1, 0.794, 0.058, 
0.48, -0.493, -0.556, -0.126, 0.7, -0.583, -0.213, 0.206, 0.794, 
1, 0.274, -0.551, 0.527, 0.395, 0.75, -0.091, 0.428, -0.656, 
-0.57, 0.058, 0.274, 1), .Dim = c(11L, 11L), .Dimnames = list(
    c("mpg", "cyl", "disp", "hp", "drat", "wt", "qsec", "vs", 
    "am", "gear", "carb"), c("mpg", "cyl", "disp", "hp", "drat", 
    "wt", "qsec", "vs", "am", "gear", "carb")))

test_that("'order' returns correct matrix", {
  expect_equal(round(cmat1,3), cmat2)
  })
               
